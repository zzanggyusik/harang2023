{% extends "base.html" %}

{% block title %}
Register
{% endblock %}

{% block content %}
<style>
    .input-field {
        position: relative;
        width: 300px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
    }
    .input-field label {
        position: absolute;
        padding-left: 10px;
        padding-top: 10px;
        color: gray;
    }
    .input-field input {
        width: 100%;
        padding: 10px;
        box-sizing: border-box;
    }
    .control-group {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    form {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .belt-field {
        display: flex;
        align-items: center;
    }
    .add-belt-button {
        margin-left: 10px;
    }
    .id-field {
        display: flex;
        align-items: center;
    }
    .check-id-button {
        margin-left: 10px;
    }
</style>

<script>
    function addBeltField() {
        var beltField = document.createElement('div');
        beltField.className = 'input-field';
        var label = document.createElement('label');
        var input = document.createElement('input');
        input.type = 'text';
        input.name = 'belt[]';
        input.placeholder = 'Conveyor Belt';  
        beltField.appendChild(label);
        beltField.appendChild(input);
        document.getElementById('belt-field-container').appendChild(beltField);
    }

    function checkId() {
        var id = document.getElementById('id').value;
        fetch('/check_id', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: 'id=' + encodeURIComponent(id)
        }).then(function(response) {
            return response.json();
        }).then(function(data) {
            alert(data.msg);
        });
    }
</script>

<form action="/register" method="post">
    <div class="input-field id-field">
        <input type="text" id="id" name="id" placeholder="ID" required>
        <button type="button" class="check-id-button" onclick="checkId()">중복체크</button>
    </div>
    <div class="input-field">
        <input type="password" id="password" name="password" placeholder="PWD" required>
    </div>
    <div class="input-field">
        <input type="password" id="password_check" name="password_check" placeholder="PWD Check" required>
    </div>
    <div id="belt-field-container">
        <div class="input-field belt-field">
            <input type="text" id="belt" name="belt[]" placeholder="Conveyor Belt" required>
            <button type="button" class="add-belt-button" onclick="addBeltField()">+</button>
        </div>
    </div>
    <div class="control-group">
        <input type="submit" value="Register" style="width: 300px;">
    </div>
</form>
{% endblock %}